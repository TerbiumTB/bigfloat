#include "gtest/gtest.h"
#include "bigfloat.h"

using namespace Bigfloat;

TEST(ARITMETHICS, ADD1){
    bigfloat a{"0.011111123123123123123112312312"};
    bigfloat b{"-1231242456.122676881236123415236152436512"};
    EXPECT_EQ("-1231242456.1115657581130002921130401242", (a+b).to_string(28));
}

TEST(ARITMETHICS, ADD2){
    bigfloat a{"999999999999,9999999999998"};
    a--;

    bigfloat b{"1000000000000.0000000000002"};
    ++b;
//    bigfloat::precision() = 13;
    EXPECT_EQ("2000000000000.0", (a+b).to_string(13));
}

TEST(ARITMETHICS, ADD3){
    bigfloat a{"12314234234231698766786637281766787567650.1876372991872367123987615671976238021"};
    bigfloat b{"98763754672534768523786452938745927636408716807687436587643756.62345671525761476596712435971623459134561932745912374519273645129736459127346746763478657436578346585"};
//    bigfloat::precision() = 101;
    EXPECT_EQ("98763754672534768523798767172980159335175503444969203375211406.81109401444485147836588592691385839344561932745912374519273645129736459127346746763478657436578346585", (a+b).to_string(101));
}

TEST(ARITMETHICS, MUL1){
    bigfloat a{"0.000000000007"};
    bigfloat b{"-1235676.376"};
    EXPECT_EQ("-0.000008649734632", (a*b).to_string(15));
}

TEST(ARITMETHICS, MUL2){
    bigfloat a{"-1234512671652431234125319263518724538162.91623516253712539127653612166526352717362561765276567716520"};
    bigfloat b{"-983764982374235176253912346536491235417926547236237763546725751.283645263547162534179251279654271963549172541928735128375127451291764591263519723619726451023971264519237612549176"};
    EXPECT_EQ("1214470336668923990559068314038839102202252874117680897495560920031939726277348022454933826195668968087.5455566412520028538379286312614689094710926963525509490680330243635325881477091769772767342900409321009804032374550665772131766586584045536918809738158984196966210252758752", (a*b).to_string(172));
}

TEST(ARITMETHICS, MUL3){
    bigfloat a{"1.00000000000000000000000011111123123123123123112312312"};
    bigfloat b{"-0.0000000000123612361276127461270000000000000982731928371"};
    --a;
    EXPECT_EQ("-0.000000000000000000000000000000000001373472165679029162787988214674336011047377310634846836222717584565403752", (a*b).to_string(200));
}

TEST(ARITMETHICS, DIV1){
    bigfloat a{"0.00011111123123123123123112312312"};
    bigfloat b{"-1234546545.17281728112351672486512461246541217239712"};
    EXPECT_EQ("-0.000000000000090001654182813650058556748567215865137385378392525364652150885407347620173892648513787717923835486164857468446454", (a/b).to_string(126));
}

TEST(ARITMETHICS, DIV2){
    bigfloat a = -11_bf;
    a++;
    bigfloat b{"-0.0000000000000001"};
    EXPECT_EQ("100000000000000000.0", (a/b).to_string(30));
}

TEST(ARITMETHICS, DIV3){
    bigfloat a{"12456235147681546725176453128745127863457162354769.192346651925349126534961523948715239847512835741928736541726354"};
    bigfloat b{"-0.000000"};
    EXPECT_THROW(a/b, std::overflow_error);
}

TEST(ARITMETHICS, DIV4){
    bigfloat a{"0.000001243124313549874659343678"};
    bigfloat b{"-0.15245234786516435987238653275643"};
    EXPECT_EQ("-0.000008154182805038523365862663282692843123202454510689500868324932938379182406416820315243165800766052895738683490438230713336492", (a/b).to_string(129));
}

TEST(ARITMETHICS, INT1){
    bigfloat a = bigfloat();
    bigfloat b = bigfloat(-9, 100);
    b--;
    EXPECT_EQ("-3.3333333333", (divide(b, 3) - a).to_string(10));
}

TEST(ARITMETHICS, INT2){
    bigfloat b = 112.1234_bf;
    EXPECT_EQ("-784.8638", multiply(b,-7).to_string());
}

TEST(ARITMETHICS, COM1){
    bigfloat a{"1.999999999"};
    bigfloat b{"-1.999999999"};
    EXPECT_EQ(1, (a < 2) && (1 < a) && (b > -2) && (-1 > b));
}

TEST(ARITMETHICS, COM2){
    bigfloat a{"0.999999999"};
    bigfloat b{"10000000000000000000.999999999"};
    EXPECT_EQ(1, (a < 1) && (a >= 0) && (b > 10000000));
}

TEST(ARITMETHICS, COM3){
    bigfloat a{"987126312.12435124365142"};
    bigfloat b{"987126312.124351243651423"};
    bigfloat c{"987126312.124351243651427"};
    bigfloat d{"987126312.124351243651427"};
    EXPECT_EQ(1, (a != b) && (b < c) && (d == c));
}

TEST(ARITMETHICS, COM4){
    bigfloat a{"987126312.12435124365142"};
    bigfloat b{"987126312.124351243651423"};
    bigfloat c{"987126312.124351243651427"};
    bigfloat d{"987126312.124351243651427"};
    EXPECT_EQ(1, (a != b) && (b < c) && (d == c));
}